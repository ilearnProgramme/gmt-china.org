<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>GMT 中文社区</title>
    <link>http://gmt-china.org/tags/psconvert/index.xml</link>
    <description>Recent content on GMT 中文社区</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cmn-Hans</language>
    <managingEditor>admin@gmt-china.org (GMT 中文社区)</managingEditor>
    <webMaster>admin@gmt-china.org (GMT 中文社区)</webMaster>
    <copyright>Powered by [Hugo](https://gohugo.io) &amp; Hosted by [GitHub](https://github.com/gmt-china/gmt-china.org).</copyright>
    <atom:link href="http://gmt-china.org/tags/psconvert/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>生成多页PS/PDF文件</title>
      <link>http://gmt-china.org/blog/multipage-ps/</link>
      <pubDate>Wed, 12 Oct 2016 00:00:00 +0000</pubDate>
      <author>admin@gmt-china.org (GMT 中文社区)</author>
      <guid>http://gmt-china.org/blog/multipage-ps/</guid>
      <description>&lt;p&gt;通常，在使用GMT画图时都是一个PS文件中保存一张图。因而，在需要画很多张同类型的图时，就需要生成很多个PS文件。比如要画1000个台站的波形数据，每张图只能放下20个波形，那么就需要写个循环画50张图，最终得到50个PS文件。有没有可能生成一个多页文件，每一页一张图呢？&lt;/p&gt;

&lt;p&gt;常规的做法是：先生成一堆PS文件，然后利用 &lt;code&gt;gmt psconvert -TF -Fout.pdf *.ps&lt;/code&gt;
将所有PS文件转换成一个多页PDF文件 &lt;code&gt;out.pdf&lt;/code&gt; ，最后把生成的PS文件删除。&lt;/p&gt;

&lt;p&gt;另一种做法是，直接生成一个多页PS文件，也就是把原来的脚本做小小的修改，使得所有绘图命令的输出都重定向到同一个PS文件中。比如，下面这个示例代码会生成10个PS文件，每个PS文件上写一个数字：&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/bin/bash

J=X10c/10c
R=0/10/0/10
for (( i = 0; i &amp;lt; 10; i++)); do
    PS=map_$i.ps
    gmt psxy -J$J -R$R -T -K &amp;gt; $PS
    echo 5 5 $i | gmt pstext -J$J -R$R -B1 -F+f50p -K -O &amp;gt;&amp;gt; $PS
    gmt psxy -J$J -R$R -T -O &amp;gt;&amp;gt; $PS
done
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;对上面的代码做一点微小的改动：&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/bin/bash

J=X10c/10c
R=0/10/0/10
PS=map.ps

[ -e $PS ] &amp;amp;&amp;amp; rm $PS

for (( i = 0; i &amp;lt; 10; i++)); do
    gmt psxy -J$J -R$R -T -K &amp;gt;&amp;gt; $PS
    echo 5 5 $i | gmt pstext -J$J -R$R -B1 -F+f50p -K -O &amp;gt;&amp;gt; $PS
    gmt psxy -J$J -R$R -T -O &amp;gt;&amp;gt; $PS
done
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;改动主要有三点：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;将变量 &lt;code&gt;PS&lt;/code&gt; 的定义放在了循环外部，意味着所有命令的输出都会保存到一个PS文件中&lt;/li&gt;
&lt;li&gt;第一个绘图命令的 &lt;code&gt;&amp;gt;&lt;/code&gt; 改成了 &lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt; ，以保证每次循环时不会新建PS文件&lt;/li&gt;
&lt;li&gt;循环开始前判断PS文件是否存在，若存在则删除，以避免多次执行脚本时将多次执行的结果写到同一个文件中&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;经过这样的改动之后，就生成了一个多页PS文件。可以使用&lt;code&gt;gmt psconvert -Tf map.ps&lt;/code&gt;
将其转换为多页PDF文件。&lt;/p&gt;

&lt;div class=&#34;notices warning&#34; &gt;&lt;p&gt;将多页PS文件转换为多页PDF文件时，&lt;code&gt;psconvert&lt;/code&gt; 的 &lt;code&gt;-A&lt;/code&gt; 和 &lt;code&gt;-P&lt;/code&gt; 等选项无法使用。&lt;/p&gt;
&lt;/div&gt;

</description>
    </item>
    
  </channel>
</rss>